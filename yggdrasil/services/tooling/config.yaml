name: tooling
clusterService: true
namespace: tooling
description: Tooling services Argo WF, Harbor.

project:
  name: tooling
  server: https://kubernetes.default.svc
  sourceRepos:
    - '*'

apps:
  - name: argo-workflows
    source:
      repoURL: "https://github.com/Open-Olympus-Project/tooling-argo-wf.git"
      targetRevision: dependency
      path: argo-wf
      valuesFile: "argowf.yaml"
    ingress:
      annotations:
        nginx.ingress.kubernetes.io/rewrite-target: /$2
        nginx.ingress.kubernetes.io/backend-protocol: HTTPS
        nginx.ingress.kubernetes.io/proxy-read-timeout: "21600"
        nginx.ingress.kubernetes.io/eventsource: "true"
        nginx.ingress.kubernetes.io/configuration-snippet: |
          location ~ "^/.*/metrics(/|$)" {
              deny all;
            }
      
      paths:
      - path: /argo(/|$)(.*)
        servicePort: 2746
        serviceName: argo-workflows-server
        tlsSecretName: argo-workflows-ui-tls
  - name: argo-events
    source:
      repoURL: "https://github.com/Open-Olympus-Project/tooling-argo-events.git"
      targetRevision: dependency
      path: argo-events
      valuesFile: "argo-events.yaml"
  - name: harbor
    source:
      repoURL: "https://github.com/Open-Olympus-Project/tooling-harbor.git"
      targetRevision: dependency
      path: harbor
      valuesFile: "harbor.yaml"
  - name: vault
    source:
      repoURL: "https://github.com/Open-Olympus-Project/tooling-vault.git"
      targetRevision: dependency
      path: vault
      valuesFile: "vault.yaml"
