argo-workflows:
  server:
    baseHref: /argowf/
    sso:
      issuer: https://{{ .Values.ingress.hosts.auth.host }}/
      redirectUrl: https://{{ .Values.ingress.hosts.auth.host }}/callback

    extraArgs:
      - --insecure-skip-tls-verify true
      - --insecure-skip-verify true

  controller:
    workflowNamespaces:
      - tooling
      - argo-events

janus:
  enabled: true
  host: {{ .Values.ingress.hosts.main.host | quote }}
  certmanagerIssuer:
    name: {{ .Values.ingress.certmanagerissuer | quote }}
    kind: ClusterIssuer

  ingressRoutes:
    - name: argo-workflows
      entryPoints:
        - websecure
      routes:
      - kind: Rule
        match: PathPrefix(`/argowf`)
        services:
          - name: argo-workflows-server
            port: 2746
        middlewares:
          - name: argo-stripprefix
      certificate:
        enabled: true

  middlewares:
    - name: argo-stripprefix
      spec:
        stripPrefix:
          prefixes:
            - /argowf
